<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <title>Random Character Generator</title>
  <link rel="stylesheet" type="text/css" href="/css/Styles.css">
  <link href='//fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic'
  rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Libre+Baskerville:700'
  rel='stylesheet' type='text/css'>

<script type="module" src="src/js/stat-block.js"></script>
<script type="module" src="src/js/creature-heading.js"></script>
<script type="module" src="src/js/top-stats.js"></script>
<script type="module" src="src/js/abilities-block.js"></script>
<script type="module" src="src/js/property-line.js"></script>
<script type="module" src="src/js/property-block.js"></script>

<style>
body {
margin: 0;
}

stat-block {
/* A bit of margin for presentation purposes, to show off the drop
shadow. */
margin-left: 20px;
margin-top: 20px;
}
</style>
</head>
<body>
  <h1>Gennerate Character</h1><br>
  <p><i>If you would like it to be random select: "Select Option"</i></p>
  <p>Please select your characters:</p>
  <ul>
    <li>Name:
      <input type="text" placeholder="Rick Astley" style="width: 75px; margin-left: 10px">
    </li> 
    <li>Level:
      <input id="lvl"type="number" min="1" max="1" value="1" style="width: 30px; margin-left: 10px">
    </li>
    <li>Class: 
      <select name="SelectClass" id="class" style="margin-left: 10px">
        <option value="random">Select Option</option>
        <option value="fighter">Fighter</option>
      </select>
    </li>
    <li>Race: 
      <select name="SelectRace" id="race" style="margin-left: 10px" onchange="sRaceSet(this)">
        <option value="random">Select Option</option>
        <option value="human">Human</option>
      </select>
    </li>
    <li>SubRace (if applicable):
      <select name="SelectSubRace" id="sRace" style="margin-left: 10px">
        <option value="random">Select a Race</option>
      </select>
    </li>
    <li>Ability Score Gen Method:
      <select name="SelectGenerationMethod" id="gen" style="margin-left: 10px">
        <option value="random">Select Option</option>
        <option value="Roll">Roll</option>
      </select>
    </li>
    <h2>Character:</h2>
    <button onclick="createCharacter()">Create</button>
  </ul>
  <div id="Character Output"></div>
  <script>
    function sRaceSet(r) {
      Race = r.value
      if(Race == "human") {
        document.getElementById("sRace").innerHTML= `
          <option value="random">Select Option</option>
          <option value="standard">Standard Human</option>
          <option value="Varient">Varient Human</option>
        `
      }
    }
    function createCharacter() {
      cRace = document.getElementById("race").value
      cClass = document.getElementById("class").value
      cSRace = document.getElementById("sRace").value
      cLvl = document.getElementById("lvl").value
      genMethod = document.getElementById("gen").value
      vNum= Math.floor((Math.random() * 100) + 1);
      var abilityScores = [];
      for (let i = 0; i < 6; i++) {
        const rolls = Array.from({length: 4}, () => Math.floor(Math.random() * 6) + 1);
        rolls.sort((a, b) => a - b);
        const totalScore = rolls.slice(1).reduce((sum, roll) => sum + roll, 0);
        abilityScores.push(totalScore);
      }
      abilityScores.sort((a, b) =>a - b);
      abilityScores.reverse()
      oStats = setAbilityPosition(abilityScores,cClass,vNum)
      document.getElementById("Character Output").innerHTML= `
      <stat-block>
        <abilities-block 
        data-str="${oStats[0]}"
        data-dex="${oStats[1]}"
        data-con="${oStats[2]}"
        data-int="${oStats[3]}"
        data-wis="${oStats[4]}"
        data-cha="${oStats[5]}"></abilities-block>
      </stat-block>
      `
    }
    function setAbilityPosition(stats,c,num) {
      if(c=="fighter") {
        if(num<50) {
          orgArr=[0,2,1,5,4,3]
        } else {
          orgArr=[2,0,1,5,3,4]
        }
      finalStats=[]
      for(var i=0;i<6;i++){
        finalStats[i]= stats[orgArr[i]]
      }
      return finalStats
      }
    }
  </script>
</body>
</html>